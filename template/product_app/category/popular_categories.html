<!-- product/category/popular_categories.html -->
<div class="flex items-center justify-evenly flex-wrap mt-12 child:mb-8 gap-x-8 child:items-center child:flex-col child:duration-300 child:cursor-pointer child:text-gray-800 child:dark:text-gray-300 child:relative">
    {% for category in popular_categories %}
        <a href=" " class="group flex" title="{{ category.title }}">
            {% if category.image %}
                <img src="{{ category.image.url }}"
                     class="w-[100px] h-[100px] lg:w-[120px] lg:h-[120px] object-cover group-hover:grayscale group-hover:opacity-90 duration-300 rounded-lg shadow-sm hover:shadow-md"
                     alt="{{ category.title }}"
                     loading="lazy"
                     onerror="this.src='{{ STATIC_URL }}images/default-category.png'" />
            {% else %}
                <div class="w-[100px] h-[100px] lg:w-[120px] lg:h-[120px] bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-800 dark:to-gray-900 flex items-center justify-center rounded-lg group-hover:opacity-90 duration-300 shadow-sm hover:shadow-md">
                    <svg class="w-12 h-12 text-blue-400 dark:text-blue-500" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4zm-6 3a1 1 0 112 0 1 1 0 01-2 0zm7-1a1 1 0 100 2 1 1 0 000-2z" clip-rule="evenodd"></path>
                    </svg>
                </div>
            {% endif %}
            <div class="pt-2 text-center">
                <p class="text-sm lg:text-lg line-clamp-1 font-medium group-hover:text-blue-600 dark:group-hover:text-blue-400 duration-300">
                    {{ category.title }}
                </p>
                {% if category.products_count or category.product_count %}
                    <span class="text-xs text-gray-500 dark:text-gray-400 mt-1 block">
                        {{ category.products_count|default:category.product_count }} محصول
                    </span>
                {% endif %}
            </div>
        </a>
    {% empty %}
        <div class="w-full text-center py-12">
            <div class="inline-block p-6 bg-gray-50 dark:bg-gray-800 rounded-lg">
                <svg class="w-16 h-16 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <p class="text-gray-500 dark:text-gray-400 text-lg mb-2">هیچ دسته‌بندی‌ای یافت نشد</p>
                <p class="text-gray-400 dark:text-gray-500 text-sm">به زودی دسته‌بندی‌های جدید اضافه خواهد شد</p>
            </div>
        </div>
    {% endfor %}
</div>